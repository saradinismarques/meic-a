# Challenge `Write Given Number` writeup

- Vulnerability: Format Strings Vulnerability
- Where: function `printf()`
- Impact: Since `printf(str)` is improperly used and the format string str is controlled by us, we can read arbitrary memory content, write to arbitrary memory content, and hijack the execution control flow.


## Steps to reproduce

1. This is similar to the previous challenge but now we want *target* to be a random value generated by the program and given to us during execution

2. The position in the stack of *target* variable is the same as the previous challenge but its address is different:

\$ objdump -t bin | grep target

0804a074 g     O .bss   00000004              target_after

0804a070 g     O .bss   00000004              target

0804a06c g     O .bss   00000004              target_before

3. We want to write a random number *r* of characters. The address will be sent first (4 characters), then we can send 5 times `%08x` (5\*8=40 characters) and then we want to send what's missing to have a total of *r* characters which will be *r*-(4+40)=*r*-44 so we will send `%(r-44)x`. Then if we send `%n` we will write to *target* a total of *r* characters and the flag will be printed

This was done in python using Pwntools [here](https://gitlab.rnl.tecnico.ulisboa.pt/ssof2223/writeups/ist193342/-/blob/master/lab7/write_given_number.py)



